import{d as e,r as a,o as l,B as t,c as o,e as i,W as s,w as r,X as u,l as n,ad as p,ae as m,g as c,t as d,aL as v,S as f,aU as y}from"./index.EkAmlOTP.js";import{E as g}from"./el-card.BFvwSAl-.js";import{E as _}from"./el-pagination.X9bExh1d.js";import{E as j}from"./el-tag.D8EliCui.js";import"./el-select.DT8OVSTm.js";import"./el-scrollbar.DyLwWyXi.js";import"./el-popper.BFX5_s0U.js";import{E as x,a as C}from"./el-table-column.DlljB71x.js";import"./el-tooltip.l0sNRNKZ.js";import{E as h}from"./el-dialog.BpyDtZht.js";import{g as w,A as b,U as k,a as V,D as z}from"./temp.CBEqGuMN.js";import{_ as E}from"./_plugin-vue_export-helper.BCo6x5W8.js";import"./strings.DPQkbj1A.js";import"./toNumber.Cauln8CA.js";import"./castArray.3MdzPI3w.js";import"./index.DKqu9MKD.js";import"./index.-qeOBjgU.js";import"./_baseClone.DxQ9csyK.js";import"./raf.Me6IDR57.js";import"./debounce.ZyuazCSD.js";import"./use-dialog.35SblXBb.js";import"./refs.Cw5r5QN8.js";const B={class:"dialog-footer"},S=E(e({__name:"template",setup(e){const E=a([]),S=a(""),U=a(""),D=a(""),I=a(!1),T=a(!1),K=a(),O=a(""),A=a("1");async function H(){const{data:e}=await w();E.value=e}l(async()=>{H()});const L=()=>{O.value="添加模版",U.value="",D.value="",A.value="1",I.value=!0},N=async()=>{"添加模版"==O.value?(await b({filename:U.value.trim(),text:D.value.trim()}),v.success("添加成功")):(await k({filename:U.value.trim(),oldname:S.value.trim(),text:D.value.trim()}),v.success("更新成功")),H(),U.value="",D.value="",I.value=!1},F=a([]),J=e=>{F.value=e},Q=()=>{0!==F.value.length&&y.confirm("你是否要删除选中这些 ?","提示",{confirmButtonText:"OK",cancelButtonText:"Cancel",type:"warning"}).then(()=>{for(let e=0;e<F.value.length;e++)z({filename:F.value[e].file}),E.value=E.value.filter(a=>a.file!==F.value[e].file);v({type:"success",message:"删除成功"})})},R=a(1),W=a(10),X=e=>{W.value=e},$=e=>{R.value=e},q=t(()=>{const e=(R.value-1)*W.value,a=e+W.value;return E.value.slice(e,a)});return(e,a)=>{const l=u,t=p,w=h,b=C,k=j,A=x,F=_,G=g;return i(),o("div",null,[s(w,{modelValue:I.value,"onUpdate:modelValue":a[3]||(a[3]=e=>I.value=e),title:O.value,width:"80%"},{footer:r(()=>[n("div",B,[s(t,{onClick:a[2]||(a[2]=e=>I.value=!1)},{default:r(()=>[...a[6]||(a[6]=[m("关闭",-1)])]),_:1}),s(t,{type:"primary",onClick:N},{default:r(()=>[...a[7]||(a[7]=[m("确定",-1)])]),_:1})])]),default:r(()=>[s(l,{modelValue:D.value,"onUpdate:modelValue":a[0]||(a[0]=e=>D.value=e),placeholder:"模版内容",rows:10,type:"textarea",style:{"margin-bottom":"10px"}},null,8,["modelValue"]),s(l,{modelValue:U.value,"onUpdate:modelValue":a[1]||(a[1]=e=>U.value=e),placeholder:"模版文件名"},null,8,["modelValue"])]),_:1},8,["modelValue","title"]),s(G,null,{default:r(()=>[s(t,{type:"primary",onClick:L},{default:r(()=>[...a[8]||(a[8]=[m("添加模版",-1)])]),_:1}),a[14]||(a[14]=n("div",{style:{"margin-bottom":"10px"}},null,-1)),s(A,{ref_key:"table",ref:K,data:c(q),style:{width:"100%"},onSelectionChange:J},{default:r(()=>[s(b,{type:"selection",fixed:"",prop:"ID",label:"id"}),s(b,{prop:"file",label:"模版文件名"},{default:r(e=>[s(k,{type:"success"},{default:r(()=>[m(d(e.row.file),1)]),_:2},1024)]),_:1}),s(b,{prop:"create_date",label:"创建时间",sortable:""}),s(b,{fixed:"right",label:"操作",width:"120"},{default:r(e=>[s(t,{link:"",type:"primary",size:"small",onClick:a=>(async e=>{O.value="编辑模版",U.value=e.file,S.value=e.file,D.value="",I.value=!0,T.value=!0;try{const{data:a}=await V(e.file);D.value=a.text}catch(a){v.error("获取模版内容失败")}finally{T.value=!1}})(e.row)},{default:r(()=>[...a[9]||(a[9]=[m("编辑",-1)])]),_:1},8,["onClick"]),s(t,{link:"",type:"primary",size:"small",onClick:a=>{return l=e.row,void y.confirm(`你是否要删除 ${l.file} ?`,"提示",{confirmButtonText:"OK",cancelButtonText:"Cancel",type:"warning"}).then(async()=>{await z({filename:l.file,type:l.type}),v({type:"success",message:"删除成功"}),H()});var l}},{default:r(()=>[...a[10]||(a[10]=[m("删除",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"]),a[15]||(a[15]=n("div",{style:{"margin-top":"20px"}},null,-1)),s(t,{type:"info",onClick:a[4]||(a[4]=e=>{f(()=>{E.value.forEach(e=>{K.value.toggleRowSelection(e,!0)})})})},{default:r(()=>[...a[11]||(a[11]=[m("全选",-1)])]),_:1}),s(t,{type:"warning",onClick:a[5]||(a[5]=e=>{K.value.clearSelection()})},{default:r(()=>[...a[12]||(a[12]=[m("取消选择",-1)])]),_:1}),s(t,{type:"danger",onClick:Q},{default:r(()=>[...a[13]||(a[13]=[m("批量删除",-1)])]),_:1}),a[16]||(a[16]=n("div",{style:{"margin-top":"20px"}},null,-1)),s(F,{onSizeChange:X,onCurrentChange:$,"current-page":R.value,"page-size":W.value,layout:"total, sizes, prev, pager, next, jumper","page-sizes":[10,20,30,40],total:E.value.length},null,8,["current-page","page-size","total"])]),_:1})])}}}),[["__scopeId","data-v-f46db365"]]);export{S as default};
