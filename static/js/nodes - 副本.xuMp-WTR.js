import{d as e,r as a,o as l,B as t,c as o,e as s,W as u,w as r,m as i,V as n,X as m,ae as p,l as d,ad as c,g as v,t as f,aL as g,S as y,aU as _}from"./index.o_u0uAyh.js";import{E as j}from"./el-card.CkXSqJpB.js";import{E as k}from"./el-pagination.DZcVUjRL.js";import{E as C}from"./el-tag.Bs7uEFwl.js";import"./el-select.BbRH0hiO.js";import"./el-scrollbar.B27H2Czh.js";import"./el-popper.DcqWso5-.js";import{E as w,a as h}from"./el-table-column.oruPxF13.js";import"./el-tooltip.l0sNRNKZ.js";import{E as x}from"./el-dialog.CmbfH3mU.js";import{E as b,a as V,g as z,A as D,U as I,D as E}from"./node.B0Pzl0CC.js";/* empty css                       */import{_ as U}from"./_plugin-vue_export-helper.BCo6x5W8.js";import"./strings.DSvhkfLF.js";import"./toNumber.CFkt-PCW.js";import"./castArray.BobvwChE.js";import"./index.DyHHGYjN.js";import"./index.CDHjHQxV.js";import"./_baseClone.BrwhIJg1.js";import"./raf.DkLCpKOK.js";import"./debounce.CD0nAR1M.js";import"./use-dialog.CWiRUG5C.js";import"./refs.Cw5r5QN8.js";const B={class:"dialog-footer"},N=U(e({__name:"nodes - 副本",setup(e){const U=a([]),N=a(""),S=a(""),K=a(""),L=a(""),T=a(!1),O=a(),R=a(""),A=a("1");async function H(){const{data:e}=await z();U.value=e}l(async()=>{H()});const J=()=>{R.value="添加节点",N.value="",K.value="",A.value="1",T.value=!0},F=async()=>{let e=N.value.split(/[\r\n,]/);if(e=e.map(e=>e.trim()).filter(e=>""!==e),"添加节点"==R.value){if("1"===A.value){if(""===K.value.trim())return void g.error("备注不能为空");e&&(N.value=e.join(","),await D({link:N.value.trim(),name:K.value.trim()}))}else for(let a=0;a<e.length;a++)await D({link:e[a],name:""});g.success("添加成功")}else await I({oldname:L.value.trim(),oldlink:S.value.trim(),link:N.value.trim(),name:K.value.trim()}),g.success("更新成功");H(),N.value="",K.value="",T.value=!1},Q=a([]),W=e=>{Q.value=e},X=()=>{0!==Q.value.length&&_.confirm("你是否要删除选中这些 ?","提示",{confirmButtonText:"OK",cancelButtonText:"Cancel",type:"warning"}).then(()=>{for(let e=0;e<Q.value.length;e++)E({id:Q.value[e].ID}),U.value=U.value.filter(a=>a.ID!==Q.value[e].ID);g({type:"success",message:"删除成功"})})},$=a(1),q=a(10),G=e=>{q.value=e},M=e=>{$.value=e},P=t(()=>{const e=($.value-1)*q.value,a=e+q.value;return U.value.slice(e,a)}),Y=e=>{(e=>{const a=document.createElement("textarea");a.value=e,document.body.appendChild(a),a.select();try{const e=document.execCommand("copy");g({type:e?"success":"warning",message:e?"复制成功！":"复制失败！"})}catch(l){g({type:"warning",message:"复制失败！"})}finally{document.body.removeChild(a)}})(e.Link)};return(e,a)=>{const l=m,t=V,z=b,D=c,I=x,Q=h,Z=C,ee=w,ae=k,le=j;return s(),o("div",null,[u(I,{modelValue:T.value,"onUpdate:modelValue":a[4]||(a[4]=e=>T.value=e),title:R.value,width:"80%"},{footer:r(()=>[d("div",B,[u(D,{onClick:a[3]||(a[3]=e=>T.value=!1)},{default:r(()=>[...a[9]||(a[9]=[p("关闭",-1)])]),_:1}),u(D,{type:"primary",onClick:F},{default:r(()=>[...a[10]||(a[10]=[p("确定",-1)])]),_:1})])]),default:r(()=>[u(l,{modelValue:N.value,"onUpdate:modelValue":a[0]||(a[0]=e=>N.value=e),placeholder:"请输入节点多行使用回车或逗号分开,支持base64格式的url订阅",type:"textarea",style:{"margin-bottom":"10px"},autosize:{minRows:2,maxRows:10}},null,8,["modelValue"]),"添加节点"==R.value?(s(),i(z,{key:0,modelValue:A.value,"onUpdate:modelValue":a[1]||(a[1]=e=>A.value=e),class:"ml-4"},{default:r(()=>[u(t,{value:"1",size:"large"},{default:r(()=>[...a[7]||(a[7]=[p("合并",-1)])]),_:1}),u(t,{value:"2",size:"large"},{default:r(()=>[...a[8]||(a[8]=[p("分开",-1)])]),_:1})]),_:1},8,["modelValue"])):n("",!0),"2"!=A.value?(s(),i(l,{key:1,modelValue:K.value,"onUpdate:modelValue":a[2]||(a[2]=e=>K.value=e),placeholder:"请输入备注"},null,8,["modelValue"])):n("",!0)]),_:1},8,["modelValue","title"]),u(le,null,{default:r(()=>[u(D,{type:"primary",onClick:J},{default:r(()=>[...a[11]||(a[11]=[p("添加节点",-1)])]),_:1}),a[18]||(a[18]=d("div",{style:{"margin-bottom":"10px"}},null,-1)),u(ee,{ref_key:"table",ref:O,data:v(P),style:{width:"100%"},onSelectionChange:W},{default:r(()=>[u(Q,{type:"selection",fixed:"",prop:"ID",label:"id"}),u(Q,{prop:"Name",label:"备注"},{default:r(e=>[u(Z,{type:"success"},{default:r(()=>[p(f(e.row.Name),1)]),_:2},1024)]),_:1}),u(Q,{prop:"Link",label:"节点",sortable:"","show-overflow-tooltip":!0}),u(Q,{prop:"CreateDate",label:"创建时间",sortable:""}),u(Q,{fixed:"right",label:"操作",width:"120"},{default:r(e=>[u(D,{link:"",type:"primary",size:"small",onClick:a=>Y(e.row)},{default:r(()=>[...a[12]||(a[12]=[p("复制",-1)])]),_:1},8,["onClick"]),u(D,{link:"",type:"primary",size:"small",onClick:a=>(e=>{A.value="1";for(let a=0;a<U.value.length;a++)U.value[a].ID===e.ID&&(R.value="编辑节点",K.value=U.value[a].Name,L.value=K.value,N.value=U.value[a].Link,S.value=N.value,T.value=!0)})(e.row)},{default:r(()=>[...a[13]||(a[13]=[p("编辑",-1)])]),_:1},8,["onClick"]),u(D,{link:"",type:"primary",size:"small",onClick:a=>{return l=e.row,void _.confirm(`你是否要删除 ${l.Name} ?`,"提示",{confirmButtonText:"OK",cancelButtonText:"Cancel",type:"warning"}).then(async()=>{await E({id:l.ID}),g({type:"success",message:"删除成功"}),H()});var l}},{default:r(()=>[...a[14]||(a[14]=[p("删除",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"]),a[19]||(a[19]=d("div",{style:{"margin-top":"20px"}},null,-1)),u(D,{type:"info",onClick:a[5]||(a[5]=e=>{y(()=>{U.value.forEach(e=>{O.value.toggleRowSelection(e,!0)})})})},{default:r(()=>[...a[15]||(a[15]=[p("全选",-1)])]),_:1}),u(D,{type:"warning",onClick:a[6]||(a[6]=e=>{O.value.clearSelection()})},{default:r(()=>[...a[16]||(a[16]=[p("取消选择",-1)])]),_:1}),u(D,{type:"danger",onClick:X},{default:r(()=>[...a[17]||(a[17]=[p("批量删除",-1)])]),_:1}),a[20]||(a[20]=d("div",{style:{"margin-top":"20px"}},null,-1)),u(ae,{onSizeChange:G,onCurrentChange:M,"current-page":$.value,"page-size":q.value,layout:"total, sizes, prev, pager, next, jumper","page-sizes":[10,20,30,40],total:U.value.length},null,8,["current-page","page-size","total"])]),_:1})])}}}),[["__scopeId","data-v-dcce509d"]]);export{N as default};
